@model Personal_Management.Models.Sotrs

@{
    ViewBag.Title = "Шаблон личного дела сотрудника";
}
<div class="container">
    
    <h2>ШАБЛОН ЛИЧНОГО ДЕЛА | <a href="#" id="btn-export" onclick="generatePDF('');">СКАЧАТЬ</a> | <a href="@Session["perehod"].ToString()">Вернуться назад</a></h2>
    <hr />
    <div style="text-align:center; margin: 0 auto; background-color:lightgray; width:80%; margin-bottom:50px;">
        <div style="text-align:center; padding:25px 15px 10px 25px" id="source-html">
            <h2 style="font-weight: 1;">
                Общество с ограниченной ответственностью<br />
                «Си эМ эС»
            </h2>
            <p style="margin-bottom: 0rem;">ОГРН 0000000000000 ИНН 0000000000 КПП 000000000</p>
            <br />
            <p style="margin-bottom: 0rem;">108840, город Москва, город Троицк, улица Промышленная, дом 19, офис 33</p>
            <hr />

            <h2 style="margin-top:100px">ЛИЧНОЕ ДЕЛО №@Html.DisplayFor(model => model.ID_Sotr)</h2>
            <dl class="dl-horizontal">

                <dd>
                    <h4 style="font-weight: 1; margin-top:60px">@Model.Surname_Sot</h4>
                </dd>

                <dd>
                    <h4 style="font-weight: 1; margin-top:20px">@Model.Name_Sot</h4>
                </dd>

                <dd>
                    <h4 style="font-weight: 1; margin-top:20px">@Model.Petronumic_Sot</h4>
                </dd>

                <dd style=" margin-top:100px; text-align:left">
                    Начато: __.____________ 20__ г.
                </dd>

                <dd style=" margin-top:40px; text-align:left">
                    Окончено: __.____________ 20__ г.
                </dd>

                <dd style=" margin-top:100px; text-align:right">
                    На ___ листах
                </dd>

                <dd style=" margin-top:40px; text-align:right">
                    Срок хранения ___ лет
                </dd>



            </dl>
        </div>
    </div>
    </div>



<script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.1.min.js"></script>
<script type="text/javascript" src="https://raw.githack.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
<script type="text/javascript">
    function generatePDF() {
        // Choose the element that our invoice is rendered in.
        const element = document.getElementById("source-html");
        // Choose the element and save the PDF for our user.
        var opt = {
            margin: [0.5, 1, 1, 1],
            filename: 'Шаблон личного дела.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            pagebreak: { mode: 'avoid-all', before: '#page2el' },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };
        // Choose the element and save the PDF for our user.
        html2pdf().from(element).set(opt).save();
    }
</script>